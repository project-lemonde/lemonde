# 開発ガイド (DEVELOPMENT.md)

## 1. 概要
このドキュメントは、Project LeMonde に貢献する開発者および AI エージェントに必要な技術知識、周辺技術、および開発プラクティスを概説します。

## 2. コア技術スタック
このプロジェクトでは、主に以下の技術を利用します。

- **プログラミング言語:** TypeScript
- **フロントエンドフレームワーク:** React
- **3Dレンダリングエンジン:** Babylon.js
- **リアルタイムコミュニケーション:** WebRTC (P2Pデータ、音声、ビデオ用)
- **共同編集:** CRDT (例: Yjs) (コンフリクトフリーなデータ同期用)
- **パッケージ管理:** pnpm (モノレポおよび依存関係管理用)
- **ビルドツール / 開発サーバー:** Vite
- **バージョン管理:** Git / GitHub

## 3. 必要な技術知識
開発者および AI エージェントは、以下の分野の知識を習得または保有している必要があります。

- **TypeScript & モダンJavaScript (ES6+):** 型、async/await、モジュールなどに関する深い理解。
- **React:** コンポーネントベースのアーキテクチャ、フック、状態管理、コンテキストAPI。
- **Babylon.js:** シーングラフ、メッシュ、マテリアル、ライト、カメラ、アニメーション、およびパフォーマンス最適化。3D数学（ベクトル、行列、クォータニオン）の理解が非常に役立ちます。
- **WebRTC:** P2P接続、データチャネル、STUN/TURNサーバー、シグナリングメカニズム。
- **CRDT (Yjs または類似のもの):** リアルタイム共同編集アプリケーションを構築するためのCRDTの原則の理解。共有データ型を構造化および管理する方法。
- **Node.js:** バックエンドサービス、ツール、またはシグナリングサーバーの実装の可能性。
- **フロントエンドビルドツール (Vite):** 設定、プラグイン、および最適化。
- **バージョン管理 (Git):** ブランチ、マージ、プルリクエスト、および共同ワークフロー。
- **ネットワークプロトコル:** TCP/IP、UDP、HTTP/HTTPSの基礎。
- **ソフトウェアデザインパターン:** 保守可能でスケーラブルなコードを作成するため。
- **テスト:** ユニットテスト (例: Vitest, Jest)、インテグレーションテスト、およびエンドツーエンドテスト (例: Playwright, Cypress)。
- **セキュリティベストプラクティス:** 特にP2P環境、データ検証、および一般的なWeb脆弱性（XSS、CSRF）の防止。

## 4. 周辺技術とコンセプト
これらの技術に精通していることは、現在または将来の開発に役立ちます。

- **WebAssembly (Wasm):** パフォーマンスが重要なモジュール用 (例: 物理演算、複雑な計算)。
- **WebSockets:** シグナリングまたは特定の種類のクライアントサーバー通信のためのWebRTCの代替または補足として。
- **WebXR:** 将来のAR/VR統合用。
- **AI/MLライブラリ (例: TensorFlow.js, ONNX.js):** AI支援によるコンテンツ作成、NPCの行動、またはモデレーションの実装用。
- **分散ストレージ (例: IPFS):** ユーザー生成コンテンツを分散型で保存するため。
- **IDおよび認証システム:** 分散型識別子（DID）、自己主権型アイデンティティ（SSI）の概念（ユーザー証明書用）。
- **ブロックチェーン/DLT:** 仮想通貨またはNFTのような資産所有権との潜在的な統合用（MVPの主要な焦点ではありません）。
- **コンテナ化 (Docker):** 開発および展開環境の標準化用。
- **CI/CD (例: GitHub Actions):** テストおよび展開パイプラインの自動化用。

## 5. 開発プラクティス
- **モノレポ構造:** pnpmワークスペースを利用した複数パッケージの管理 (例: `apps/`, `packages/`)。
- **コードスタイルとリンティング:** ESLint、Prettier、Biomeなどのツールを使用した強制。
- **アジャイル方法論:** 反復開発、定期的なスプリント、およびフィードバックループ。
- **コードレビュー:** すべてのコード変更はマージ前にレビューされる必要があります。
- **包括的なドキュメンテーション:** コード、API、およびアーキテクチャ上の決定の文書化。
- **テスト駆動開発 (TDD) / ビヘイビア駆動開発 (BDD):** 該当する場合に推奨。

## 6. AIエージェント向け情報
開発またはサポートに関与するAIエージェントは、以下を実行できる必要があります。

- **コア技術スタックの理解:** 互換性のある効率的なコードを生成するため。
- **開発プラクティスの遵守:** コードスタイル、テスト、ドキュメンテーションを含む。
- **PRDおよび技術仕様の解釈:** 要件を理解し、それに応じて機能を実装するため。
- **モノレポ構造での作業:** 正しいパッケージ内のコードをナビゲートおよび変更する。
- **提供されたAPIの利用:** システムのさまざまな部分（例: 3Dシーン、共同編集状態、AIサービス）と対話するため。
- **デバッグと問題解決の支援:** コードを分析し、解決策を提案することによって。
- **ドキュメンテーションへの貢献:** 技術ドキュメントの生成または更新。
- **コラボレーションのためのデータ構造の理解:** Yjsまたは他のCRDTが共有状態（例: 3Dオブジェクトの位置、プロパティ、シーン階層）をどのように表現および同期するか。
- **自律的な空間作成/サポートのためのインターフェース:**
    - **入力:** ユーザープロンプト、既存のシーンデータ、事前定義されたテンプレート、コンテキスト情報。
    - **出力:** CRDT共有状態への変更（新しいオブジェクト、変換されたオブジェクト）、ユーザーへの提案、手続き型生成パラメータ。
    - **機能:** オブジェクトの配置、マテリアルの適用、環境生成、NPCのパスファインディング（将来）、インタラクティブなチュートリアル。

このドキュメントは、プロジェクトの進化に合わせて更新されます。
